! function(l) {
    "use strict";
    l("#sidebarToggle, #sidebarToggleTop").on("click", function(e) { l("body").toggleClass("sidebar-toggled"), l(".sidebar").toggleClass("toggled"), l(".sidebar").hasClass("toggled") && l(".sidebar .collapse").collapse("hide") }), l(window).resize(function() { l(window).width() < 768 && l(".sidebar .collapse").collapse("hide"), l(window).width() < 480 && !l(".sidebar").hasClass("toggled") && (l("body").addClass("sidebar-toggled"), l(".sidebar").addClass("toggled"), l(".sidebar .collapse").collapse("hide")) }), l("body.fixed-nav .sidebar").on("mousewheel DOMMouseScroll wheel", function(e) {
        var o;
        768 < l(window).width() && (o = (o = e.originalEvent).wheelDelta || -o.detail, this.scrollTop += 30 * (o < 0 ? 1 : -1), e.preventDefault())
    }), l(document).on("scroll", function() { 100 < l(this).scrollTop() ? l(".scroll-to-top").fadeIn() : l(".scroll-to-top").fadeOut() }), l(document).on("click", "a.scroll-to-top", function(e) {
        var o = l(this);
        l("html, body").stop().animate({ scrollTop: l(o.attr("href")).offset().top }, 1e3, "easeInOutExpo"), e.preventDefault()
    })
}(jQuery);

$(document).ready(function() {
    $('#formThemBacSi').on('submit', function(e) {
        e.preventDefault();
        const hoTen = $('#hoTen').val();
        const chuyenNganh = $('#chuyenNganh').val();
        const soDienThoai = $('#soDienThoai').val();
        const email = $('#email').val();
        const phoneRegex = /^(03|05|07|08|09)[0-9]{8}$/;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

        if (!hoTen) {
            alert('Vui lòng nhập họ tên.');
            return;
        }
        if (!chuyenNganh) {
            alert('Vui lòng nhập chuyên ngành.');
            return;
        }
        if (!phoneRegex.test(soDienThoai)) {
            alert('Số điện thoại không hợp lệ. Vui lòng nhập số điện thoại bắt đầu bằng 03, 05, 07, 08, hoặc 09 và gồm 10 số.');
            return;
        }
        if (!emailRegex.test(email)) {
            alert('Email không hợp lệ. Vui lòng nhập email đúng định dạng (ví dụ: example@gmail.com).');
            return;
        }

        if (!hoTen || !chuyenNganh || !soDienThoai || !email) {
            alert('Vui lòng nhập đầy đủ thông tin bác sĩ.');
            return;
        }

        const bacSiMoi = { hoTen, chuyenNganh, soDienThoai, email };
        let danhSachBacSi = JSON.parse(localStorage.getItem('danhSachBacSi')) || [];
        if (danhSachBacSi.some(bacSi => bacSi.email === email)) {
            alert('Bác sĩ này đã tồn tại trong danh sách.');
            return;
        }
        danhSachBacSi.push(bacSiMoi);
        localStorage.setItem('danhSachBacSi', JSON.stringify(danhSachBacSi));
        window.location.href = 'doctor.html';
    });
    const danhSachBacSi = JSON.parse(localStorage.getItem('danhSachBacSi')) || [];
    const tbody = $('#dataTable tbody');
    tbody.empty();
    danhSachBacSi.forEach((bacSi, index) => {
        const row = `
        <tr>
            <td>${bacSi.hoTen}</td>
            <td>${bacSi.chuyenNganh}</td>
            <td>${bacSi.soDienThoai}</td>
            <td>${bacSi.email}</td>
            <td>
                <button class="btn btn-primary btn-sua" data-index="${index}">Sửa</button>
            </td>
            <td>
                <button class="btn btn-primary btn-xoa" data-index="${index}">Xóa</button>
            </td>
        </tr>
    `;
        tbody.append(row);
    });
    $('.btn-xoa').off('click').on('click', function() {
        const index = $(this).data('index');
        danhSachBacSi.splice(index, 1);
        localStorage.setItem('danhSachBacSi', JSON.stringify(danhSachBacSi));
        $(this).closest('tr').remove();
    });

});
$(document).ready(function() {
    $('#formThemBenhNhan').on('submit', function(e) {
        e.preventDefault();
        const hoTenBN = $('#hoTenBN').val();
        const addressBN = $('#addressBN').val();
        const ngaySinhBN = $('#ngaySinhBN').val();
        const soDienThoaiBN = $('#soDienThoaiBN').val();
        const emailBN = $('#emailBN').val();
        const phoneRegex = /^(03|05|07|08|09)[0-9]{8}$/;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

        if (!hoTenBN) {
            alert('Vui lòng nhập họ tên.');
            return;
        }
        if (!ngaySinhBN) {
            alert('Vui lòng nhập ngày sinh.');
            return;
        }
        if (!addressBN) {
            alert('Vui lòng nhập đia chỉ.');
            return;
        }
        if (!phoneRegex.test(soDienThoaiBN)) {
            alert('Số điện thoại không hợp lệ. Vui lòng nhập số điện thoại bắt đầu bằng 03, 05, 07, 08, hoặc 09 và gồm 10 số.');
            return;
        }
        // if (!emailRegex.test(email)) {
        //     alert('Email không hợp lệ. Vui lòng nhập email đúng định dạng (ví dụ: example@gmail.com).');
        //     return;
        // }

        if (!hoTenBN || !ngaySinhBN || !addressBN || !soDienThoaiBN || !emailBN) {
            alert('Vui lòng nhập đầy đủ thông tin bệnh nhân.');
            return;
        }

        const benhNhanMoi = { hoTenBN, addressBN, soDienThoaiBN, emailBN };
        let danhSachBenhNhan = JSON.parse(localStorage.getItem('danhSachBenhNhan')) || [];
        if (danhSachBenhNhan.some(benhNhan => benhNhan.email === email)) {
            alert('Bệnh nhân này đã tồn tại trong danh sách.');
            return;
        }
        danhSachBenhNhan.push(benhNhanMoi);
        localStorage.setItem('danhSachBenhNhan', JSON.stringify(danhSachBenhNhan));
        window.location.href = 'patient.html';
    });
    const danhSachBenhNhan = JSON.parse(localStorage.getItem('danhSachBenhNhan')) || [];
    const tbody = $('#dataTable tbody');
    tbody.empty();
    danhSachBenhNhan.forEach((benhNhan, index) => {
        const row = `
        <tr>
            <td>${benhNhan.hoTenBN}</td>
            <td>${benhNhan.ngaySinhBN}</td>
            <td>${benhNhan.addressBN}</td>
            <td>${benhNhan.soDienThoaiBN}</td>
            <td>${benhNhan.emailBN}</td>
            <td>
                <button class="btn btn-primary btn-sua" data-index="${index}">Sửa</button>
            </td>
            <td>
                <button class="btn btn-primary btn-xoa" data-index="${index}">Xóa</button>
            </td>
        </tr>
    `;
        tbody.append(row);
    });
    $('.btn-xoa').off('click').on('click', function() {
        const index = $(this).data('index');
        danhSachBenhNhan.splice(index, 1);
        localStorage.setItem('danhSachBenhNhan', JSON.stringify(danhSachBenhNhan));
        $(this).closest('tr').remove();
    });

});
// $(document).ready(function() {
//     $('#formThemBenhAn').on('submit', function(e) {
//         e.preventDefault();

//         const hoTenBN = $('#hoTenBN').val();
//         const hoTenBS = $('#hoTenBS').val();
//         const trieuChung = $('#trieuChung').val();
//         const chuanDoan = $('#chuanDoan').val();
//         const donThuoc = $('#donThuoc').val();

//         if (!hoTenBN || !hoTenBS || !trieuChung || !chuanDoan || !donThuoc) {
//             alert('Vui lòng nhập đầy đủ thông tin!');
//             return;
//         }

//         const benhAnMoi = { hoTenBN, hoTenBS, trieuChung, chuanDoan, donThuoc };

//         let danhSachBenhAn = JSON.parse(localStorage.getItem('danhSachBenhAn')) || [];

//         if (danhSachBenhAn.some(benhAn => benhAn.hoTenBN === hoTenBN && benhAn.hoTenBS === hoTenBS)) {
//             alert('Bệnh án cho bệnh nhân này với bác sĩ này đã tồn tại trong danh sách.');
//             return;
//         }

//         danhSachBenhAn.push(benhAnMoi);
//         localStorage.setItem('danhSachBenhAn', JSON.stringify(danhSachBenhAn));

//         // Chuyển hướng sang trang danh sách bệnh án
//         window.location.href = 'medicalrecord.html';
//     });

//     // Hiển thị danh sách bệnh án trên bảng
//     const danhSachBenhAn = JSON.parse(localStorage.getItem('danhSachBenhAn')) || [];
//     const tbody = $('#dataTable tbody');
//     tbody.empty();
//     danhSachBenhAn.forEach((benhAn, index) => {
//         const row = `
//         <tr>
//             <td>${benhAn.hoTenBN}</td>
//             <td>${benhAn.hoTenBS}</td>
//             <td>${benhAn.trieuChung}</td>
//             <td>${benhAn.chuanDoan}</td>
//             <td>${benhAn.donThuoc}</td>
//             <td>
//                 <button class="btn btn-primary btn-sua" data-index="${index}">Sửa</button>
//             </td>
//             <td>
//                 <button class="btn btn-primary btn-xoa" data-index="${index}">Xóa</button>
//             </td>
//         </tr>
//     `;
//         tbody.append(row);
//     });

//     // Xóa bệnh án khỏi danh sách
//     $('.btn-xoa').off('click').on('click', function() {
//         const index = $(this).data('index');
//         danhSachBenhAn.splice(index, 1);
//         localStorage.setItem('danhSachBenhAn', JSON.stringify(danhSachBenhAn));
//         $(this).closest('tr').remove();
//     });
// });
$(document).ready(function() {
    // Xử lý form thêm bệnh án
    $('#formThemBenhAn').on('submit', function(e) {
        e.preventDefault();

        const hoTenBN = $('#hoTenBN').val();
        const hoTenBS = $('#hoTenBS').val();
        const trieuChung = $('#trieuChung').val();
        const chuanDoan = $('#chuanDoan').val();
        const donThuoc = $('#donThuoc').val();

        if (!hoTenBN || !hoTenBS || !trieuChung || !chuanDoan || !donThuoc) {
            alert('Vui lòng nhập đầy đủ thông tin!');
            return;
        }

        const benhNhanMoi = { hoTenBN, hoTenBS, trieuChung, chuanDoan, donThuoc };
        let danhSachBenhAn = JSON.parse(localStorage.getItem('danhSachBenhAn')) || [];

        if (danhSachBenhAn.some(benhAn => benhAn.hoTenBN === hoTenBN && benhAn.hoTenBS === hoTenBS)) {
            alert('Bệnh án cho bệnh nhân này với bác sĩ này đã tồn tại.');
            return;
        }

        danhSachBenhAn.push(benhNhanMoi);
        localStorage.setItem('danhSachBenhAn', JSON.stringify(danhSachBenhAn));

        alert('Thêm bệnh án thành công!');
        // Hiển thị lại dữ liệu trong bảng
        hienThiDanhSachBenhAn();
        window.location.href = 'medicalrecord.html';
        // Xóa giá trị trong form sau khi submit
        $('#formThemBenhAn')[0].reset();
    });

    // Hàm hiển thị danh sách bệnh án từ localStorage
    function hienThiDanhSachBenhAn() {
        const danhSachBenhAn = JSON.parse(localStorage.getItem('danhSachBenhAn')) || [];
        const tbody = $('#dataTable tbody');
        tbody.empty();

        danhSachBenhAn.forEach((benhAn, index) => {
            const row = `
            <tr>
                <td>${benhAn.hoTenBN}</td>
                <td>${benhAn.hoTenBS}</td>
                <td>${benhAn.trieuChung}</td>
                <td>${benhAn.chuanDoan}</td>
                <td>${benhAn.donThuoc}</td>
                <td>
                    <button class="btn btn-primary btn-sua" data-index="${index}">Sửa</button>
                </td>
                <td>
                    <button class="btn btn-primary btn-xoa" data-index="${index}">Xóa</button>
                </td>
            </tr>
            `;
            tbody.append(row);
        });

        // Xử lý nút xóa
        $('.btn-xoa').off('click').on('click', function() {
            const index = $(this).data('index');
            danhSachBenhAn.splice(index, 1);
            localStorage.setItem('danhSachBenhAn', JSON.stringify(danhSachBenhAn));
            hienThiDanhSachBenhAn();
        });
    }

    // Hiển thị dữ liệu khi tải trang
    hienThiDanhSachBenhAn();
});